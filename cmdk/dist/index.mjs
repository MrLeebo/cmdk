import{a as le}from"./chunk-NZJY6EH4.mjs";import*as w from"@radix-ui/react-dialog";import*as n from"react";import{useSyncExternalStore as be}from"use-sync-external-store/shim";import{Primitive as I}from"@radix-ui/react-primitive";var N='[cmdk-group=""]',Q='[cmdk-group-items=""]',he='[cmdk-group-heading=""]',Z='[cmdk-item=""]',ue=`${Z}:not([aria-disabled="true"])`,Y="cmdk-item-select",M="data-value",ye=(t,o,r)=>le(t,o,r),fe=n.createContext(void 0),K=()=>n.useContext(fe),me=n.createContext(void 0),ee=()=>n.useContext(me),pe=n.createContext(void 0),de=(()=>{let t=0;return()=>`${t++}`})(),L=()=>{n.useState(de);let[t]=n.useState(de);return"cmdk"+t},ve=n.forwardRef((t,o)=>{let r=k(()=>{var e,s;return{search:"",value:(s=(e=t.value)!=null?e:t.defaultValue)!=null?s:"",filtered:{count:0,items:new Map,groups:new Set}}}),u=k(()=>new Set),c=k(()=>new Map),d=k(()=>new Map),f=k(()=>new Set),p=ge(t),{label:v,children:b,value:l,onValueChange:y,filter:E,shouldFilter:C,loop:H,disablePointerSelection:te=!1,vimBindings:$=!0,...O}=t,ne=L(),B=L(),F=L(),x=n.useRef(null),R=ke();T(()=>{if(l!==void 0){let e=l.trim();r.current.value=e,h.emit()}},[l]),T(()=>{R(6,oe)},[]);let h=n.useMemo(()=>({subscribe:e=>(f.current.add(e),()=>f.current.delete(e)),snapshot:()=>r.current,setState:(e,s,i)=>{var a,m,g;if(!Object.is(r.current[e],s)){if(r.current[e]=s,e==="search")W(),U(),R(1,z);else if(e==="value"&&(i||R(5,oe),((a=p.current)==null?void 0:a.value)!==void 0)){let S=s!=null?s:"";(g=(m=p.current).onValueChange)==null||g.call(m,S);return}h.emit()}},emit:()=>{f.current.forEach(e=>e())}}),[]),q=n.useMemo(()=>({value:(e,s,i)=>{var a;s!==((a=d.current.get(e))==null?void 0:a.value)&&(d.current.set(e,{value:s,keywords:i}),r.current.filtered.items.set(e,re(s,i)),R(2,()=>{U(),h.emit()}))},item:(e,s)=>(u.current.add(e),s&&(c.current.has(s)?c.current.get(s).add(e):c.current.set(s,new Set([e]))),R(3,()=>{W(),U(),r.current.value||z(),h.emit()}),()=>{d.current.delete(e),u.current.delete(e),r.current.filtered.items.delete(e);let i=A();R(4,()=>{W(),(i==null?void 0:i.getAttribute("id"))===e&&z(),h.emit()})}),group:e=>(c.current.has(e)||c.current.set(e,new Set),()=>{d.current.delete(e),c.current.delete(e)}),filter:()=>p.current.shouldFilter,label:v||t["aria-label"],disablePointerSelection:te,listId:ne,inputId:F,labelId:B,listInnerRef:x}),[]);function re(e,s){var a,m;let i=(m=(a=p.current)==null?void 0:a.filter)!=null?m:ye;return e?i(e,r.current.search,s):0}function U(){if(!r.current.search||p.current.shouldFilter===!1)return;let e=r.current.filtered.items,s=[];r.current.filtered.groups.forEach(a=>{let m=c.current.get(a),g=0;m.forEach(S=>{let P=e.get(S);g=Math.max(P,g)}),s.push([a,g])});let i=x.current;_().sort((a,m)=>{var P,V;let g=a.getAttribute("id"),S=m.getAttribute("id");return((P=e.get(S))!=null?P:0)-((V=e.get(g))!=null?V:0)}).forEach(a=>{let m=a.closest(Q);m?m.appendChild(a.parentElement===m?a:a.closest(`${Q} > *`)):i.appendChild(a.parentElement===i?a:a.closest(`${Q} > *`))}),s.sort((a,m)=>m[1]-a[1]).forEach(a=>{var g;let m=(g=x.current)==null?void 0:g.querySelector(`${N}[${M}="${encodeURIComponent(a[0])}"]`);m==null||m.parentElement.appendChild(m)})}function z(){let e=_().find(i=>i.getAttribute("aria-disabled")!=="true"),s=e==null?void 0:e.getAttribute(M);h.setState("value",s||void 0)}function W(){var s,i,a,m;if(!r.current.search||p.current.shouldFilter===!1){r.current.filtered.count=u.current.size;return}r.current.filtered.groups=new Set;let e=0;for(let g of u.current){let S=(i=(s=d.current.get(g))==null?void 0:s.value)!=null?i:"",P=(m=(a=d.current.get(g))==null?void 0:a.keywords)!=null?m:[],V=re(S,P);r.current.filtered.items.set(g,V),V>0&&e++}for(let[g,S]of c.current)for(let P of S)if(r.current.filtered.items.get(P)>0){r.current.filtered.groups.add(g);break}r.current.filtered.count=e}function oe(){var s,i,a;let e=A();e&&(((s=e.parentElement)==null?void 0:s.firstChild)===e&&((a=(i=e.closest(N))==null?void 0:i.querySelector(he))==null||a.scrollIntoView({block:"nearest"})),e.scrollIntoView({block:"nearest"}))}function A(){var e;return(e=x.current)==null?void 0:e.querySelector(`${Z}[aria-selected="true"]`)}function _(){var e;return Array.from(((e=x.current)==null?void 0:e.querySelectorAll(ue))||[])}function J(e){let i=_()[e];i&&h.setState("value",i.getAttribute(M))}function X(e){var g;let s=A(),i=_(),a=i.findIndex(S=>S===s),m=i[a+e];(g=p.current)!=null&&g.loop&&(m=a+e<0?i[i.length-1]:a+e===i.length?i[0]:i[a+e]),m&&h.setState("value",m.getAttribute(M))}function ie(e){let s=A(),i=s==null?void 0:s.closest(N),a;for(;i&&!a;)i=e>0?Te(i,N):De(i,N),a=i==null?void 0:i.querySelector(ue);a?h.setState("value",a.getAttribute(M)):X(e)}let ae=()=>J(_().length-1),se=e=>{e.preventDefault(),e.metaKey?ae():e.altKey?ie(1):X(1)},ce=e=>{e.preventDefault(),e.metaKey?J(0):e.altKey?ie(-1):X(-1)};return n.createElement(I.div,{ref:o,tabIndex:-1,...O,"cmdk-root":"",onKeyDown:e=>{var s;if((s=O.onKeyDown)==null||s.call(O,e),!e.defaultPrevented)switch(e.key){case"n":case"j":{$&&e.ctrlKey&&se(e);break}case"ArrowDown":{se(e);break}case"p":case"k":{$&&e.ctrlKey&&ce(e);break}case"ArrowUp":{ce(e);break}case"Home":{e.preventDefault(),J(0);break}case"End":{e.preventDefault(),ae();break}case"Enter":if(!e.nativeEvent.isComposing&&e.keyCode!==229){e.preventDefault();let i=A();if(i){let a=new Event(Y);i.dispatchEvent(a)}}}}},n.createElement("label",{"cmdk-label":"",htmlFor:q.inputId,id:q.labelId,style:He},v),j(t,e=>n.createElement(me.Provider,{value:h},n.createElement(fe.Provider,{value:q},e))))}),Se=n.forwardRef((t,o)=>{var F,x;let r=L(),u=n.useRef(null),c=n.useContext(pe),d=K(),f=ge(t),p=(x=(F=f.current)==null?void 0:F.forceMount)!=null?x:c==null?void 0:c.forceMount;T(()=>{if(!p)return d.item(r,c==null?void 0:c.id)},[p]);let v=Re(r,u,[t.value,t.children,u],t.keywords),b=ee(),l=D(R=>R.value&&R.value===v.current),y=D(R=>p||d.filter()===!1?!0:R.search?R.filtered.items.get(r)>0:!0);n.useEffect(()=>{let R=u.current;if(!(!R||t.disabled))return R.addEventListener(Y,E),()=>R.removeEventListener(Y,E)},[y,t.onSelect,t.disabled]);function E(){var R,h;C(),(h=(R=f.current).onSelect)==null||h.call(R,v.current)}function C(){b.setState("value",v.current,!0)}if(!y)return null;let{disabled:H,value:te,onSelect:$,forceMount:O,keywords:ne,...B}=t;return n.createElement(I.div,{ref:G([u,o]),...B,id:r,"cmdk-item":"",role:"option","aria-disabled":!!H,"aria-selected":!!l,"data-disabled":!!H,"data-selected":!!l,onPointerMove:H||d.disablePointerSelection?void 0:C,onClick:H?void 0:E},t.children)}),Ee=n.forwardRef((t,o)=>{let{heading:r,children:u,forceMount:c,...d}=t,f=L(),p=n.useRef(null),v=n.useRef(null),b=L(),l=K(),y=D(C=>c||l.filter()===!1?!0:C.search?C.filtered.groups.has(f):!0);T(()=>l.group(f),[]),Re(f,p,[t.value,t.heading,v]);let E=n.useMemo(()=>({id:f,forceMount:c}),[c]);return n.createElement(I.div,{ref:G([p,o]),...d,"cmdk-group":"",role:"presentation",hidden:y?void 0:!0},r&&n.createElement("div",{ref:v,"cmdk-group-heading":"","aria-hidden":!0,id:b},r),j(t,C=>n.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?b:void 0},n.createElement(pe.Provider,{value:E},C))))}),Ce=n.forwardRef((t,o)=>{let{alwaysRender:r,...u}=t,c=n.useRef(null),d=D(f=>!f.search);return!r&&!d?null:n.createElement(I.div,{ref:G([c,o]),...u,"cmdk-separator":"",role:"separator"})}),xe=n.forwardRef((t,o)=>{let{onValueChange:r,...u}=t,c=t.value!=null,d=ee(),f=D(l=>l.search),p=D(l=>l.value),v=K(),b=n.useMemo(()=>{var y;let l=(y=v.listInnerRef.current)==null?void 0:y.querySelector(`${Z}[${M}="${encodeURIComponent(p)}"]`);return l==null?void 0:l.getAttribute("id")},[]);return n.useEffect(()=>{t.value!=null&&d.setState("search",t.value)},[t.value]),n.createElement(I.input,{ref:o,...u,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":v.listId,"aria-labelledby":v.labelId,"aria-activedescendant":b,id:v.inputId,type:"text",value:c?t.value:f,onChange:l=>{c||d.setState("search",l.target.value),r==null||r(l.target.value)}})}),Pe=n.forwardRef((t,o)=>{let{children:r,label:u="Suggestions",...c}=t,d=n.useRef(null),f=n.useRef(null),p=K();return n.useEffect(()=>{if(f.current&&d.current){let v=f.current,b=d.current,l,y=new ResizeObserver(()=>{l=requestAnimationFrame(()=>{let E=v.offsetHeight;b.style.setProperty("--cmdk-list-height",E.toFixed(1)+"px")})});return y.observe(v),()=>{cancelAnimationFrame(l),y.unobserve(v)}}},[]),n.createElement(I.div,{ref:G([d,o]),...c,"cmdk-list":"",role:"listbox","aria-label":u,id:p.listId},j(t,v=>n.createElement("div",{ref:G([f,p.listInnerRef]),"cmdk-list-sizer":""},v)))}),we=n.forwardRef((t,o)=>{let{open:r,onOpenChange:u,overlayClassName:c,contentClassName:d,container:f,...p}=t;return n.createElement(w.Root,{open:r,onOpenChange:u},n.createElement(w.Portal,{container:f},n.createElement(w.Overlay,{"cmdk-overlay":"",className:c}),n.createElement(w.Content,{"aria-label":t.label,"cmdk-dialog":"",className:d},n.createElement(ve,{ref:o,...p}))))}),Ie=n.forwardRef((t,o)=>D(u=>u.filtered.count===0)?n.createElement(I.div,{ref:o,...t,"cmdk-empty":"",role:"presentation"}):null),Me=n.forwardRef((t,o)=>{let{progress:r,children:u,label:c="Loading...",...d}=t;return n.createElement(I.div,{ref:o,...d,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":c},j(t,f=>n.createElement("div",{"aria-hidden":!0},f)))}),Ve=Object.assign(ve,{List:Pe,Item:Se,Input:xe,Group:Ee,Separator:Ce,Dialog:we,Empty:Ie,Loading:Me});function Te(t,o){let r=t.nextElementSibling;for(;r;){if(r.matches(o))return r;r=r.nextElementSibling}}function De(t,o){let r=t.previousElementSibling;for(;r;){if(r.matches(o))return r;r=r.previousElementSibling}}function ge(t){let o=n.useRef(t);return T(()=>{o.current=t}),o}var T=typeof window=="undefined"?n.useEffect:n.useLayoutEffect;function k(t){let o=n.useRef();return o.current===void 0&&(o.current=t()),o}function G(t){return o=>{t.forEach(r=>{typeof r=="function"?r(o):r!=null&&(r.current=o)})}}function D(t){let o=ee(),r=()=>t(o.snapshot());return be(o.subscribe,r,r)}function Re(t,o,r,u=[]){let c=n.useRef(),d=K();return T(()=>{var v;let f=(()=>{var b;for(let l of r){if(typeof l=="string")return l.trim();if(typeof l=="object"&&"current"in l)return l.current?(b=l.current.textContent)==null?void 0:b.trim():c.current}})(),p=u.map(b=>b.trim());d.value(t,f,p),(v=o.current)==null||v.setAttribute(M,f),c.current=f}),c}var ke=()=>{let[t,o]=n.useState(),r=k(()=>new Map);return T(()=>{r.current.forEach(u=>u()),r.current=new Map},[t]),(u,c)=>{r.current.set(u,c),o({})}};function Le(t){let o=t.type;return typeof o=="function"?o(t.props):"render"in o?o.render(t.props):t}function j({asChild:t,children:o},r){return t&&n.isValidElement(o)?n.cloneElement(Le(o),{ref:o.ref},r(o.props.children)):r(o)}var He={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};export{Ve as Command,we as CommandDialog,Ie as CommandEmpty,Ee as CommandGroup,xe as CommandInput,Se as CommandItem,Pe as CommandList,Me as CommandLoading,ve as CommandRoot,Ce as CommandSeparator,ye as defaultFilter,D as useCommandState};
